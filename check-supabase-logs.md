# üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Supabase Edge Function

## –®–∞–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://supabase.com/dashboard
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç `fhtvxziachtotvtjxsgp`
3. –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Edge Functions
1. –í –ª–µ–≤–æ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ **Edge Functions**
2. –ù–∞–π–¥–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `ai-mediator`
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ—ë

### 3. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Logs**
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏
3. –ò—â–∏—Ç–µ –æ—à–∏–±–∫–∏ (–∫—Ä–∞—Å–Ω—ã–µ –∑–∞–ø–∏—Å–∏)

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **Environment Variables**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `GIGACHAT_API_KEY`
3. –ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `NGQzNWJkMTgtMjhmMi00ODQzLTliZWEtZTllYzUwZmQ2MzUwOmYwZWE3NWI4LWM5ZTAtNDM1OC1iOWJjLWNmNGUzYjQwZmFiNA==`

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 1: –§—É–Ω–∫—Ü–∏—è –Ω–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞
**–†–µ—à–µ–Ω–∏–µ**: –§—É–Ω–∫—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–æ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –≤—Ä–µ–º—è

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π API –∫–ª—é—á
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `GIGACHAT_API_KEY`

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 3: CORS –æ—à–∏–±–∫–∏
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ CORS –≤ —Ñ—É–Ω–∫—Ü–∏–∏

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 4: –¢–∞–π–º–∞—É—Ç
**–†–µ—à–µ–Ω–∏–µ**: GigaChat –º–æ–∂–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ, —É–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã:

### –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏
fetch('/functions/v1/ai-mediator', { method: 'OPTIONS' })
  .then(r => console.log('CORS OK:', r.status))
  .catch(e => console.error('CORS Error:', e));

// –¢–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
fetch('/functions/v1/ai-mediator', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    partner1_message: '–¢–µ—Å—Ç 1',
    partner2_message: '–¢–µ—Å—Ç 2'
  })
}).then(r => r.json()).then(console.log).catch(console.error);
```

## –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö:

1. **üîë "GigaChat API key available: true"** - –∫–ª—é—á –∑–∞–≥—Ä—É–∂–µ–Ω
2. **üì® "Messages received"** - —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω—ã
3. **üîê "Requesting token"** - –∑–∞–ø—Ä–æ—Å —Ç–æ–∫–µ–Ω–∞
4. **‚úÖ "Token data received"** - —Ç–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω
5. **ü§ñ "Sending chat request"** - –∑–∞–ø—Ä–æ—Å –∫ GigaChat
6. **‚úÖ "Chat data received"** - –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω
7. **üí° "Recommendation received"** - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞

## –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é** –≤ Supabase Dashboard
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å GigaChat API** –Ω–∞ —Å–∞–π—Ç–µ –°–±–µ—Ä–∞
3. **–û–±–Ω–æ–≤–∏—Ç–µ API –∫–ª—é—á** –µ—Å–ª–∏ –æ–Ω –∏—Å—Ç–µ–∫
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–≤–æ—Ç—ã** –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API